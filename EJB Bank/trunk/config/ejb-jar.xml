<!DOCTYPE ejb-jar PUBLIC "-//Sun Microsystems, Inc.//DTD Enterprice JavaBeans 2.0//EN" "http://java.sun.com/dtd/ejb-jar_2_0.dtd">

<ejb-jar>
	<enterprise-beans>
		<entity>
		    <ejb-name>AccountEJB</ejb-name>
			<home>com.vgsoftware.bank.account.AccountHome</home>
			<remote>com.vgsoftware.bank.account.AccountRemote</remote>
		    <ejb-class>com.vgsoftware.bank.account.AccountBean</ejb-class>
		    <persistence-type>Container</persistence-type>
		    <prim-key-class>java.lang.Integer</prim-key-class>
		    <reentrant>False</reentrant>
		    <cmp-version>2.x</cmp-version>
		    <abstract-schema-name>AccountAPS</abstract-schema-name>
		    <cmp-field>
		        <field-name>user</field-name>
		    </cmp-field>
		    <cmp-field>
		        <field-name>number</field-name>
		    </cmp-field>
		    <cmp-field>
		    	<field-name>balance</field-name>
		    </cmp-field>
		    <primkey-field>number</primkey-field>
			<query>
				<query-method>
					<method-name>findByOwner</method-name>
				</query-method>
				<ejb-ql>
					SELECT OBJECT(a) FROM AccountAPS AS a WHERE a.user=?1
				</ejb-ql>
			</query>
			<query>
				<query-method>
					<method-name>findAll</method-name>
				</query-method>
				<ejb-ql>
					SELECT OBJECT(a) FROM AccountAPS AS a
				</ejb-ql>
			</query>
			<security-identity><use-caller-identity/></security-identity>
		</entity>
		<entity>
		    <ejb-name>UserEJB</ejb-name>
			<home>com.vgsoftware.bank.user.UserHome</home>
			<remote>com.vgsoftware.bank.user.UserRemote</remote>
		    <ejb-class>com.vgsoftware.bank.user.UserBean</ejb-class>
		    <persistence-type>Container</persistence-type>
		    <prim-key-class>java.lang.String</prim-key-class>
		    <reentrant>False</reentrant>
		    <cmp-version>2.x</cmp-version>
		    <abstract-schema-name>UserAPS</abstract-schema-name>
		    <cmp-field>
		        <field-name>name</field-name>
		    </cmp-field>
		    <cmp-field>
		        <field-name>password</field-name>
		    </cmp-field>
		    <cmp-field>
		    	<field-name>type</field-name>
		    </cmp-field>
		    <primkey-field>name</primkey-field>
			<query>
				<query-method>
					<method-name>findAllByType</method-name>
				</query-method>
				<ejb-ql>
					SELECT OBJECT(a) FROM UserAPS AS a WHERE a.type=?1
				</ejb-ql>
			</query>
			<security-identity><use-caller-identity/></security-identity>
		</entity>
		<session>
			<ejb-name>Customer</ejb-name>
			<home>com.vgsoftware.bank.customer.CustomerHome</home>
			<remote>com.vgsoftware.bank.customer.CustomerRemote</remote>
			<ejb-class>com.vgsoftware.bank.customer.CustomerBean</ejb-class>
			<session-type>Statefull</session-type>
			<transaction-type>Container</transaction-type>
			<security-identity><use-caller-identity/></security-identity>
			<ejb-ref>
				<ejb-ref-name>UserEJB</ejb-ref-name>
				<ejb-ref-type>Entity</ejb-ref-type>
				<home>com.vgsoftware.bank.user.UserHome</home>
				<remote>com.vgsoftware.bank.user.UserRemote</remote>
			</ejb-ref>
			<ejb-ref>
				<ejb-ref-name>AccountEJB</ejb-ref-name>
				<ejb-ref-type>Entity</ejb-ref-type>
				<home>com.vgsoftware.bank.account.AccountHome</home>
				<remote>com.vgsoftware.bank.account.AccountRemote</remote>
			</ejb-ref>
		</session>
		<session>
			<ejb-name>Admin</ejb-name>
			<home>com.vgsoftware.bank.admin.AdminHome</home>
			<remote>com.vgsoftware.bank.admin.AdminRemote</remote>
			<ejb-class>com.vgsoftware.bank.admin.AdminBean</ejb-class>
			<session-type>Statefull</session-type>
			<transaction-type>Container</transaction-type>
			<security-identity><use-caller-identity/></security-identity>
			<ejb-ref>
				<ejb-ref-name>UserEJB</ejb-ref-name>
				<ejb-ref-type>Entity</ejb-ref-type>
				<home>com.vgsoftware.bank.user.UserHome</home>
				<remote>com.vgsoftware.bank.user.UserRemote</remote>
			</ejb-ref>
			<ejb-ref>
				<ejb-ref-name>AccountEJB</ejb-ref-name>
				<ejb-ref-type>Entity</ejb-ref-type>
				<home>com.vgsoftware.bank.account.AccountHome</home>
				<remote>com.vgsoftware.bank.account.AccountRemote</remote>
			</ejb-ref>
		</session>
	</enterprise-beans>
	<assembly-descriptor>
		<security-role>
			<role-name>guest</role-name>
			<description>Guest Users</description>
		</security-role>
		<security-role>
			<role-name>user</role-name>
			<description>Registed Users</description>
		</security-role>
		<security-role>
			<role-name>admin</role-name>
			<description>Admin Users</description>
		</security-role>
	</assembly-descriptor>
</ejb-jar>